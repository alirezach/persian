{
  "hash": "995aca2d1d3b7a702632c5e62c44fe9a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"المپیک زیر ذره‌بین\"\ndescription: \"بررسی تاریخی داده‌های المپیک با تاکید بر برابری جنسیتی\"\nauthor: \"علیرضا چمن‌زار\"\ndate: \"2024-09-03\"\nimage: featured.jpg\ndate-format: short\ncategories: [تحلیل داده, داده]\neditor: \n  markdown: \n    wrap: sentence\n    location: block\n    prefix: \"mydoc\"\ntoc: true\ncitation:\n  url: https://bit.ly/Olympic-history\nappendix-cite-as: display\nformat:\n  html:\n    code-fold: false\n    code-tools: false\nexecute:\n  warning: false\n  message: false\nengine: knitr\n---\n\n\n\n![](featured.jpg){fig-align=\"center\"}\n\n## توضیحات کلی\n\n این یادداشت و بررسی قرار بود در میانه‌ی المپیک ۲۰۲۴ که مسئله زنان داغ بود در پاسخ به سؤالی که برای من ایجاد شده بود شکل بگیرد که به دلیل مشغله‌ها و درگیری‌های این مدت عقب افتاد.\nپرسش من در نسبت با برابری جنسیتی در تاریخ المپیک بود که محرکی شد که به دنبال دیتاست‌های تاریخ المپیک بگردم.\nدر سایت کگل چند تا دیتاست تاریخی دیدم که هیچ‌کدام کامل نبود و همچنین یکی از کاربران دیتاست المپیک ۲۰۲۴ را نیز به‌صورت روزانه به‌روز می‌کرد و این شد که در مرحله اول تا تکمیل این دیتاست این کار عقب افتاد و بعد مشغله‌ها تأثیر خودشان رو گذاشتند.\\\nاما در پاسخ به سؤال اصلی که برابری جنسیتی در طول تاریخ چه مسیری را طی کرده، پاسخ کوتاه مسیر مثبت به سمت برابری کامل هست.\nاز اولین دوره که در سال ۱۸۹۶ برگزار شده و هیچ زنی در المپیک شرکت نکرده تا امروز که تقریباً نسبت ۵۰/۵۰ در المپیک رعایت شده است.\nاین مورد در چارت‌های زیر مشخص هست.\\\n\n![چارت 1](gender_inequality_in_years.jpg)\\\n\nو همچنین در چارت زیر که نسبت برابری جنسیتی در طول تاریخ مشخص شده‌است.\n0 به معنای عدم وجود برابری و 1 به معنای برابری جنسیتی کامل هست.\n\n![چارت 2](gender_ratio.jpg)\\\n\nبرای نگاه کلی به تعداد کلی ورزشکاران در عمر المپیک نیز اطلاعات در چارت زیر نمایش داده‌شده‌است:\n\n![چارت 3](plot_participants.jpg){fig-align=\"center\"}\n\nو برترین کشورها از نظر تعداد مدالی که توانسته‌اند کسب کنند را در چارت 4م می‌توانید ببینید.\n\n![چارت ۴](waffle_chart.jpg){fig-align=\"center\"}\n\nالبته از تحلیل داده‌ها میشه جزییات بیشتر در مورد موضوعات دیگه و چارت‌های دیگری بیرون کشید که از ابتدا برنامه آن نبود و البته وقتی برای انجامش نداشتم.\n\nاین پروژه با R انجام شده و کدها ، داده‌ها و مراحل آن در ادامه در دسترس هست و بخشی از چارت‌های دیگر که در این فرایند نمایش داده شده را به صورت اینتراکتیو می‌توانید ببینید.\n\nهمچنین دیتاست نهایی این کار که پس از تجمیع و پاک‌سازی داده‌های موجود انجام شده در سایت Kaggle آپلود شده که از [اینجا](https://www.kaggle.com/datasets/alirezachamanzar/olympic-history-1896-2024)می‌توانید به آن دسترسی داشته باشید.\n\n## مراحل انجام کار\n\n### کتابخانه‌های مورد نیاز\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(janitor)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(tibble)\nlibrary(plotly)\nlibrary(htmlwidgets)\nlibrary(lubridate)\nlibrary(stringr)\nlibrary(hrbrthemes)\n```\n:::\n\n\n\n### داده‌ها\n\nداده‌های استفاده شده در این یادداشت همگی از سایت کگل دانلود شده‌اند.\nکامل‌ترین داده از سال 1896 تا 2016 بود و داده‌های 2020 و 2024 در فایل‌های جداگانه‌ای دانلود شدند و تجمیع شدند.\n\n[120 years of Olympic history: athletes and results](https://www.kaggle.com/datasets/heesoo37/120-years-of-olympic-history-athletes-and-results/data) (Kaggle)\n\n[Tokyo 2020 Olympics Dataset](https://www.kaggle.com/datasets/aliaamiri/2020-summer-olympics-dataset) (Kaggle)\n\n[Beijing Olympic(2022) athlete Profile](https://www.kaggle.com/datasets/kukuroo3/beijing-olympic2022-athlete-profile) (Kaggle)\n\n[The total number of medals in Beijing Olympic,2022](https://www.kaggle.com/datasets/kitsune1999/the-total-number-of-medals-in-beijing-olympic2022) (kaggle)\n\n[Paris 2024 Olympic Summer Games](https://www.kaggle.com/datasets/piterfm/paris-2024-olympic-summer-games/data) (Kaggle)\n\n### فراخوانی داده‌ها\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_history <- read.csv(\"1896-2016-120-years-of-Olympic-history-athletes-and-results/athlete_events.csv\" )\ndata_2020 <- read.csv(\"2020-Tokyo-Olympics-Dataset/2020_Olympics_Dataset.csv\")\ndata_2022 <- read.csv(\"2022-Beijing-Olympic-athlete-Profile/beijing_Olympic_athlete_profile.csv\")\ndata_2024_list <- read.csv(\"2024-Paris-Olympic-Summer-Games/athletes.csv\")\ndata_2024_medalist <- read.csv(\"2024-Paris-Olympic-Summer-Games/medallists.csv\")\nnoc2country <- read.csv(\"NOC/noc2country.csv\")\n```\n:::\n\n\n\n### بررسی اولیه داده‌ها\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## 1896-2016\ntibble(data_history)\n## 2020\ntibble(data_2020)\n## 2022 Athlets\ntibble(data_2022)\n## 2024-list\ntibble(data_2024_list)\n## 2024-medalist\ntibble(data_2024_medalist)\n```\n:::\n\n\n\n## پاکسازی و تجمیع داده‌ها\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Preapring Dataset 1896-2016\nglimpse(data_history)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 271,116\nColumns: 15\n$ ID     <int> 1, 2, 3, 4, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, …\n$ Name   <chr> \"A Dijiang\", \"A Lamusi\", \"Gunnar Nielsen Aaby\", \"Edgar Lindenau…\n$ Sex    <chr> \"M\", \"M\", \"M\", \"M\", \"F\", \"F\", \"F\", \"F\", \"F\", \"F\", \"M\", \"M\", \"M\"…\n$ Age    <int> 24, 23, 24, 34, 21, 21, 25, 25, 27, 27, 31, 31, 31, 31, 33, 33,…\n$ Height <int> 180, 170, NA, NA, 185, 185, 185, 185, 185, 185, 188, 188, 188, …\n$ Weight <dbl> 80, 60, NA, NA, 82, 82, 82, 82, 82, 82, 75, 75, 75, 75, 75, 75,…\n$ Team   <chr> \"China\", \"China\", \"Denmark\", \"Denmark/Sweden\", \"Netherlands\", \"…\n$ NOC    <chr> \"CHN\", \"CHN\", \"DEN\", \"DEN\", \"NED\", \"NED\", \"NED\", \"NED\", \"NED\", …\n$ Games  <chr> \"1992 Summer\", \"2012 Summer\", \"1920 Summer\", \"1900 Summer\", \"19…\n$ Year   <int> 1992, 2012, 1920, 1900, 1988, 1988, 1992, 1992, 1994, 1994, 199…\n$ Season <chr> \"Summer\", \"Summer\", \"Summer\", \"Summer\", \"Winter\", \"Winter\", \"Wi…\n$ City   <chr> \"Barcelona\", \"London\", \"Antwerpen\", \"Paris\", \"Calgary\", \"Calgar…\n$ Sport  <chr> \"Basketball\", \"Judo\", \"Football\", \"Tug-Of-War\", \"Speed Skating\"…\n$ Event  <chr> \"Basketball Men's Basketball\", \"Judo Men's Extra-Lightweight\", …\n$ Medal  <chr> NA, NA, NA, \"Gold\", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n```\n\n\n:::\n\n```{.r .cell-code}\ndata_history_clean <- data_history %>%\n  clean_names() %>% \n  select(name, sex, age, country = team ,noc,year, season, sport, medal)\n\ndata_history_clean <- data_history_clean %>%\n  mutate(sex = case_when(\n    sex == \"M\" ~ \"Male\",\n    sex == \"F\" ~ \"Female\",\n    TRUE ~ sex\n  ))\n\n\n#Preapring Dataset 2020\ndata_2020_clean <- data_2020 %>%\n  mutate(season = \"summer\") %>%\n  select(Name, sex=Gender, Age, Country ,NOC,year, season, sport =Discipline, Medal) %>%\n  clean_names()\n\n#Preapring Dataset 2022\ndata_2022 <- data_2022 %>%\n  mutate(participating.countries = recode(participating.countries,\n                                          \"Virgin Islands, US\" = \"United States\",\n                                          \"United States of America\" = \"United States\",\n                                          \"ROC\" = \"Russia\",\n                                          \"People's Republic of China\" = \"China\",\n                                          \"Republic of Korea\" = \"South Korea\",\n                                          \"Democratic Republic of Timor-Leste\" = \"Timor Leste\",\n                                          \"Hong Kong, China\" = \"Hong Kong\",\n                                          \"North Macedonia\" = \"Macedonia\",\n                                          \"Islamic Republic of Iran\" = \"Iran\"))\n\ndata_2022_clean <- data_2022 %>%\n  mutate(medal = NA) %>%\n  mutate(year = 2022) %>% \n  mutate(season = \"winter\") %>% \n  left_join(noc2country, by = c(\"participating.countries\" = \"country\")) %>%\n  select(name, sex = Gender, age = Age, country = participating.countries, noc, year, season, sport = Occupation, medal) %>%\n  clean_names()\n\n\n##\ndata_2024_list <- data_2024_list %>% \n  clean_names() %>% \n  mutate(year= 2024) %>% \n  mutate(season=\"summer\")\n  \ndata_2024_medalist <- data_2024_medalist %>% \n  clean_names() %>% \n  mutate(year=2024) %>% \n  mutate(season=\"summer\")\n  \n#Perpairing Dataset 2024\n##calculate age of athlets\ndata_2024_list <- data_2024_list %>%\n  mutate(birth_date = ymd(birth_date)) %>%\n  mutate(Age = year(today()) - year(birth_date))\n\ndata_2024_medalist <- data_2024_medalist %>%\n  mutate(birth_date = ymd(birth_date)) %>%\n  mutate(Age = year(today()) - year(birth_date))\n## \nnew_entries <- data_2024_list %>%\n  anti_join(data_2024_medalist, by = c(\"code\" = \"code_athlete\")) %>%\n  mutate(year=2024) %>% \n  select(name, gender, Age, country, country_code, year, discipline = disciplines) %>%\n  mutate(medal_type = NA) %>% \n  mutate(discipline = str_remove_all(discipline, \"\\\\[|\\\\]|'\"))\n\ndata_2024_medalist <- data_2024_medalist %>%\n  bind_rows(new_entries)\n\n## Create new Dataset 2024\ndata_2024_clean <- data_2024_medalist %>%\n    select(name, sex= gender, Age, country, noc=country_code, year, season, sport = discipline, medal=medal_type) %>% \n  mutate(medal=str_replace(medal,\" Medal\",\"\"))%>%\n  mutate(season = \"summer\") %>% \n  clean_names()\n\n#Create a Main dataset 1896-2024\nolympic_1896_2024 <- bind_rows(\n  data_history_clean %>% select(name, sex, age, medal, year, season, country, noc),\n  data_2020_clean %>% select(name, sex, age, medal, year, season, country, noc),\n  data_2022_clean %>% select(name, sex, age, medal, year, season, country, noc),\n  data_2024_clean %>% select(name, sex, age, medal, year, season, country, noc)\n)\n## mutate country again with noc table\nolympic_1896_2024_clean <- olympic_1896_2024 %>% \n  select(-country) %>% \n  left_join(noc2country, by = \"noc\") %>% \n  select(-full.title, -ISO) %>% \n  filter(is.na(name) | nzchar(name)) %>% \n  mutate(name = str_replace_all(name, \"^.|'|\\\\s{2}\", \"\"),\n         season = tolower(season))\n```\n:::\n\n\n\n## ذخیره فایل نهایی\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(olympic_1896_2024_clean, file = \"olympic_1896_2024.csv\", row.names = FALSE)\n```\n:::\n\n\n\n## خروجی نهایی\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(head(olympic_1896_2024_clean))\n```\n:::\n\n\n\n## از دریچه نمودارها\n\n## تعداد کلی شرکت‌کننده‌ها\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparticipant_counts <- olympic_1896_2024_clean %>%\n  distinct(name, year, season) %>%\n  group_by(year, season) %>%\n  summarise(Count = n(), .groups = 'drop')\n\n# ترسیم نمودار\nplot_participants <- ggplot(participant_counts, aes(x = year, y = Count, color = season)) +\n  geom_point(size = 3, alpha = 0.5) +\n  geom_line(linewidth = 2) +\n  geom_vline(xintercept = 1914, linetype = \"dashed\", color = \"red\", size = 0.5, alpha = 0.3) +\n  geom_vline(xintercept = 1918, linetype = \"dashed\", color = \"red\", size = 0.5, alpha = 0.3) +\n  geom_vline(xintercept = 1939, linetype = \"dashed\", color = \"blue\", size = 0.5, alpha = 0.3) +\n  geom_vline(xintercept = 1945, linetype = \"dashed\", color = \"blue\", size = 0.5, alpha = 0.3) +\n  annotate(\"text\", x = 1916, y = 8000, \n           label = \"WWI\", color = \"red\", vjust = -1) +\n  annotate(\"text\", x = 1942, y = 9000, \n           label = \"WWII\", color = \"blue\", vjust = -1) +\n  labs(title = \"Participation in Olympics\",\n       subtitle = \"1896~2024\",\n       x = \"year\",\n       y = \"Athlets\",\n       caption = \"Chart by: Alireza Chamanzar\\nData: Kaggle's community\") +\n  scale_color_manual(values = c(\"summer\" = \"orange\", \"winter\" = \"blue\"))+\n  theme_minimal()+\n  theme(legend.position = \"top\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplotly(plot_participants)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-424da99326380706a010\" style=\"width:100%;height:278px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-424da99326380706a010\">{\"x\":{\"data\":[{\"x\":[1896,1900,1904,1906,1908,1912,1920,1924,1928,1932,1936,1948,1952,1956,1960,1964,1968,1972,1976,1980,1984,1988,1992,1996,2000,2004,2008,2012,2016,2020,2024],\"y\":[176,1219,650,841,2024,2409,2675,3256,3246,1922,4482,4402,4931,3346,5348,5134,5552,7105,6070,5252,6789,8442,9379,10321,10637,10530,10866,10499,11171,11625,11095],\"text\":[\"year: 1896<br />Count:   176<br />season: summer\",\"year: 1900<br />Count:  1219<br />season: summer\",\"year: 1904<br />Count:   650<br />season: summer\",\"year: 1906<br />Count:   841<br />season: summer\",\"year: 1908<br />Count:  2024<br />season: summer\",\"year: 1912<br />Count:  2409<br />season: summer\",\"year: 1920<br />Count:  2675<br />season: summer\",\"year: 1924<br />Count:  3256<br />season: summer\",\"year: 1928<br />Count:  3246<br />season: summer\",\"year: 1932<br />Count:  1922<br />season: summer\",\"year: 1936<br />Count:  4482<br />season: summer\",\"year: 1948<br />Count:  4402<br />season: summer\",\"year: 1952<br />Count:  4931<br />season: summer\",\"year: 1956<br />Count:  3346<br />season: summer\",\"year: 1960<br />Count:  5348<br />season: summer\",\"year: 1964<br />Count:  5134<br />season: summer\",\"year: 1968<br />Count:  5552<br />season: summer\",\"year: 1972<br />Count:  7105<br />season: summer\",\"year: 1976<br />Count:  6070<br />season: summer\",\"year: 1980<br />Count:  5252<br />season: summer\",\"year: 1984<br />Count:  6789<br />season: summer\",\"year: 1988<br />Count:  8442<br />season: summer\",\"year: 1992<br />Count:  9379<br />season: summer\",\"year: 1996<br />Count: 10321<br />season: summer\",\"year: 2000<br />Count: 10637<br />season: summer\",\"year: 2004<br />Count: 10530<br />season: summer\",\"year: 2008<br />Count: 10866<br />season: summer\",\"year: 2012<br />Count: 10499<br />season: summer\",\"year: 2016<br />Count: 11171<br />season: summer\",\"year: 2020<br />Count: 11625<br />season: summer\",\"year: 2024<br />Count: 11095<br />season: summer\"],\"type\":\"scatter\",\"mode\":\"markers+lines\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,165,0,1)\",\"opacity\":0.5,\"size\":11.338582677165356,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,165,0,1)\"}},\"hoveron\":\"points\",\"name\":\"summer\",\"legendgroup\":\"summer\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"line\":{\"width\":7.559055118110237,\"color\":\"rgba(255,165,0,1)\",\"dash\":\"solid\"},\"frame\":null},{\"x\":[1924,1928,1932,1936,1948,1952,1956,1960,1964,1968,1972,1976,1980,1984,1988,1992,1994,1998,2002,2006,2010,2014,2022],\"y\":[313,460,252,668,668,694,821,665,1094,1160,1008,1127,1071,1272,1425,1801,1738,2176,2397,2494,2535,2743,2874],\"text\":[\"year: 1924<br />Count:   313<br />season: winter\",\"year: 1928<br />Count:   460<br />season: winter\",\"year: 1932<br />Count:   252<br />season: winter\",\"year: 1936<br />Count:   668<br />season: winter\",\"year: 1948<br />Count:   668<br />season: winter\",\"year: 1952<br />Count:   694<br />season: winter\",\"year: 1956<br />Count:   821<br />season: winter\",\"year: 1960<br />Count:   665<br />season: winter\",\"year: 1964<br />Count:  1094<br />season: winter\",\"year: 1968<br />Count:  1160<br />season: winter\",\"year: 1972<br />Count:  1008<br />season: winter\",\"year: 1976<br />Count:  1127<br />season: winter\",\"year: 1980<br />Count:  1071<br />season: winter\",\"year: 1984<br />Count:  1272<br />season: winter\",\"year: 1988<br />Count:  1425<br />season: winter\",\"year: 1992<br />Count:  1801<br />season: winter\",\"year: 1994<br />Count:  1738<br />season: winter\",\"year: 1998<br />Count:  2176<br />season: winter\",\"year: 2002<br />Count:  2397<br />season: winter\",\"year: 2006<br />Count:  2494<br />season: winter\",\"year: 2010<br />Count:  2535<br />season: winter\",\"year: 2014<br />Count:  2743<br />season: winter\",\"year: 2022<br />Count:  2874<br />season: winter\"],\"type\":\"scatter\",\"mode\":\"markers+lines\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,0,255,1)\",\"opacity\":0.5,\"size\":11.338582677165356,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,255,1)\"}},\"hoveron\":\"points\",\"name\":\"winter\",\"legendgroup\":\"winter\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"line\":{\"width\":7.559055118110237,\"color\":\"rgba(0,0,255,1)\",\"dash\":\"solid\"},\"frame\":null},{\"x\":[1914,1914],\"y\":[-396.45000000000005,12197.450000000001],\"text\":\"xintercept: 1914\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,0,0,0.3)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1918,1918],\"y\":[-396.45000000000005,12197.450000000001],\"text\":\"xintercept: 1918\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,0,0,0.3)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1939,1939],\"y\":[-396.45000000000005,12197.450000000001],\"text\":\"xintercept: 1939\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,255,0.3)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1945,1945],\"y\":[-396.45000000000005,12197.450000000001],\"text\":\"xintercept: 1945\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,255,0.3)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1916],\"y\":[8000],\"text\":\"WWI\",\"hovertext\":\"x: 1916<br />y: 8000\",\"textfont\":{\"size\":14.66456692913386,\"color\":\"rgba(255,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1942],\"y\":[9000],\"text\":\"WWII\",\"hovertext\":\"x: 1942<br />y: 9000\",\"textfont\":{\"size\":14.66456692913386,\"color\":\"rgba(0,0,255,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":50.581430745814302,\"r\":7.3059360730593621,\"b\":47.001522070015227,\"l\":54.794520547945211},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Participation in Olympics\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[1889.5999999999999,2030.4000000000001],\"tickmode\":\"array\",\"ticktext\":[\"1920\",\"1960\",\"2000\"],\"tickvals\":[1920,1960,2000],\"categoryorder\":\"array\",\"categoryarray\":[\"1920\",\"1960\",\"2000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"year\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-396.45000000000005,12197.450000000001],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"3000\",\"6000\",\"9000\",\"12000\"],\"tickvals\":[5.6843418860808015e-14,3000,6000,9000,12000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"3000\",\"6000\",\"9000\",\"12000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Athlets\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"season\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"297c7ba0338c\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"},\"297c74f21031\":{\"x\":{},\"y\":{},\"colour\":{}},\"297cf4d11dc\":{\"xintercept\":{}},\"297c733819f9\":{\"xintercept\":{}},\"297c73653386\":{\"xintercept\":{}},\"297c2da570ae\":{\"xintercept\":{}},\"297c30953e52\":{\"x\":{},\"y\":{}},\"297c337524ec\":{\"x\":{},\"y\":{}}},\"cur_data\":\"297c7ba0338c\",\"visdat\":{\"297c7ba0338c\":[\"function (y) \",\"x\"],\"297c74f21031\":[\"function (y) \",\"x\"],\"297cf4d11dc\":[\"function (y) \",\"x\"],\"297c733819f9\":[\"function (y) \",\"x\"],\"297c73653386\":[\"function (y) \",\"x\"],\"297c2da570ae\":[\"function (y) \",\"x\"],\"297c30953e52\":[\"function (y) \",\"x\"],\"297c337524ec\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n### توزیع سنی\n\n#### توزیع سنی تاریخ المپیک (1896-2024)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nage_distribution <- olympic_1896_2024_clean %>%\n  filter(!is.na(age))\n\nage_plot <- ggplot(age_distribution, aes(x = age)) +\n  geom_histogram(binwidth = 1, fill = \"#404080\", color= \"#404080\") +\n  labs(title = \"Age distribution of athletes in the Olympics 1896-20242024\",\n       x = \"age\",\n       y = \"counts\")+\n  theme_ipsum_rc()\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-070c0b81b5bc2370da3e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-070c0b81b5bc2370da3e\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97],\"y\":[1,13,42,193,854,2256,3993,5655,8678,12393,16397,20725,22664,23987,24189,22096,19950,18313,16127,13263,11115,8895,7355,5659,4680,3636,2921,2247,1823,1578,1329,1052,942,837,728,622,462,426,424,381,293,218,263,207,167,116,140,78,89,94,90,74,66,56,30,85,33,25,25,60,29,33,24,8,12,4,7,2,0,0,3,2,0,0,1,0,0,0,3,0,0,0,0,0,0,0,1,1],\"text\":[\"count:     1<br />age: 10\",\"count:    13<br />age: 11\",\"count:    42<br />age: 12\",\"count:   193<br />age: 13\",\"count:   854<br />age: 14\",\"count:  2256<br />age: 15\",\"count:  3993<br />age: 16\",\"count:  5655<br />age: 17\",\"count:  8678<br />age: 18\",\"count: 12393<br />age: 19\",\"count: 16397<br />age: 20\",\"count: 20725<br />age: 21\",\"count: 22664<br />age: 22\",\"count: 23987<br />age: 23\",\"count: 24189<br />age: 24\",\"count: 22096<br />age: 25\",\"count: 19950<br />age: 26\",\"count: 18313<br />age: 27\",\"count: 16127<br />age: 28\",\"count: 13263<br />age: 29\",\"count: 11115<br />age: 30\",\"count:  8895<br />age: 31\",\"count:  7355<br />age: 32\",\"count:  5659<br />age: 33\",\"count:  4680<br />age: 34\",\"count:  3636<br />age: 35\",\"count:  2921<br />age: 36\",\"count:  2247<br />age: 37\",\"count:  1823<br />age: 38\",\"count:  1578<br />age: 39\",\"count:  1329<br />age: 40\",\"count:  1052<br />age: 41\",\"count:   942<br />age: 42\",\"count:   837<br />age: 43\",\"count:   728<br />age: 44\",\"count:   622<br />age: 45\",\"count:   462<br />age: 46\",\"count:   426<br />age: 47\",\"count:   424<br />age: 48\",\"count:   381<br />age: 49\",\"count:   293<br />age: 50\",\"count:   218<br />age: 51\",\"count:   263<br />age: 52\",\"count:   207<br />age: 53\",\"count:   167<br />age: 54\",\"count:   116<br />age: 55\",\"count:   140<br />age: 56\",\"count:    78<br />age: 57\",\"count:    89<br />age: 58\",\"count:    94<br />age: 59\",\"count:    90<br />age: 60\",\"count:    74<br />age: 61\",\"count:    66<br />age: 62\",\"count:    56<br />age: 63\",\"count:    30<br />age: 64\",\"count:    85<br />age: 65\",\"count:    33<br />age: 66\",\"count:    25<br />age: 67\",\"count:    25<br />age: 68\",\"count:    60<br />age: 69\",\"count:    29<br />age: 70\",\"count:    33<br />age: 71\",\"count:    24<br />age: 72\",\"count:     8<br />age: 73\",\"count:    12<br />age: 74\",\"count:     4<br />age: 75\",\"count:     7<br />age: 76\",\"count:     2<br />age: 77\",\"count:     0<br />age: 78\",\"count:     0<br />age: 79\",\"count:     3<br />age: 80\",\"count:     2<br />age: 81\",\"count:     0<br />age: 82\",\"count:     0<br />age: 83\",\"count:     1<br />age: 84\",\"count:     0<br />age: 85\",\"count:     0<br />age: 86\",\"count:     0<br />age: 87\",\"count:     3<br />age: 88\",\"count:     0<br />age: 89\",\"count:     0<br />age: 90\",\"count:     0<br />age: 91\",\"count:     0<br />age: 92\",\"count:     0<br />age: 93\",\"count:     0<br />age: 94\",\"count:     0<br />age: 95\",\"count:     1<br />age: 96\",\"count:     1<br />age: 97\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(64,64,128,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(64,64,128,1)\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":95.701120797011214,\"r\":39.850560398505614,\"b\":86.841012868410132,\"l\":93.814860938148641},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Roboto Condensed\",\"size\":15.276048152760483},\"title\":{\"text\":\"<b> Age distribution of athletes in the Olympics 1896-20242024 <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Roboto Condensed\",\"size\":23.910336239103366},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[5.0999999999999996,101.90000000000001],\"tickmode\":\"array\",\"ticktext\":[\"25\",\"50\",\"75\",\"100\"],\"tickvals\":[25,50,75,100],\"categoryorder\":\"array\",\"categoryarray\":[\"25\",\"50\",\"75\",\"100\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.8190120381901207,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Roboto Condensed\",\"size\":15.276048152760483},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(204,204,204,1)\",\"gridwidth\":0.265670402656704,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"age\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Roboto Condensed\",\"size\":11.955168119551683}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1209.45,25398.450000000001],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"5000\",\"10000\",\"15000\",\"20000\",\"25000\"],\"tickvals\":[0,5000,10000,15000,20000,25000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"5000\",\"10000\",\"15000\",\"20000\",\"25000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.8190120381901207,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Roboto Condensed\",\"size\":15.276048152760483},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(204,204,204,1)\",\"gridwidth\":0.26567040265670405,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"counts\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Roboto Condensed\",\"size\":11.955168119551683}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Roboto Condensed\",\"size\":12.220838522208389}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"297c39312322\":{\"x\":{},\"type\":\"bar\"}},\"cur_data\":\"297c39312322\",\"visdat\":{\"297c39312322\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n#### توزیع سنی به تفکیک سال (انیمیشن)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gganimate)\np <- ggplot(age_distribution, aes(x = age)) +\n  geom_histogram(binwidth = 1, fill = \"#404080\", color = \"#404080\") +\n  labs(title = 'Age distribution in: {frame_time}', x = 'Age', y = 'count') +\n  transition_time(as.integer(year))+\n  ease_aes('linear')\n\n# ذخیره انیمیشن\nanim_save(\"age_distribution_animation.gif\", animate(p, nframes = 400, fps = 20, renderer = gifski_renderer(width = 1000, height = 1000)))\n```\n:::\n\n\n\n![Age Distribution in olympics history (1896\\~2024)](age_distribution_animation.gif){fig-alt=\"Age Distribution in olympics history\" fig-align=\"center\"}\n\n### برابری جنسیتی؟ آری یا نه\n\n#### نسبت جنسیتی\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# محاسبه نسبت جنسیتی به تفکیک سال\ngender_ratio <- olympic_1896_2024_clean %>%\n  group_by(year, sex) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  pivot_wider(names_from = sex, values_from = count, values_fill = list(count = 0)) %>%\n  mutate(ratio = Female / Male)\n\n# نمایش نمودار نسبت جنسیتی به تفکیک سال\ngender_ratio <- ggplot(gender_ratio, aes(x = year, y = ratio)) +\n  geom_line(linewidth= 2, color = \"#14213d\") +\n  labs(title = \"Gender ratio in the Olympics by year\" ,\n       subtitle = \"1896~2024\",\n       x = \"year\",\n       y = \"Ratio\",\n       caption = \"Chart by: Alireza Chamanzar\\nData: Kaggle's community\")+\n  theme_minimal()\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-75d2149655c61287ed22\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-75d2149655c61287ed22\">{\"x\":{\"data\":[{\"x\":[1896,1900,1904,1906,1908,1912,1920,1924,1928,1932,1936,1948,1952,1956,1960,1964,1968,1972,1976,1980,1984,1988,1992,1994,1996,1998,2000,2002,2004,2006,2008,2010,2012,2014,2016,2020,2022,2024],\"y\":[0,0.017341040462427744,0.012451361867704281,0.006387921022067364,0.01538965291421087,0.022008601062484191,0.032227032227032229,0.048048600883652433,0.085069106482382709,0.125,0.080122591943957974,0.11326090191992856,0.21912454403335072,0.21510859301227572,0.23051299133910727,0.2267080745341615,0.26466328747284579,0.27890065233664851,0.33004052684903751,0.32380388090653239,0.34665891923300407,0.40399885200420932,0.46088117489986646,0.53771289537712896,0.57090743274053812,0.62314272850067542,0.64731823599523242,0.62603878116343492,0.70229200962390781,0.66933333333333334,0.74698176213716927,0.72289628180039134,0.81843771991555248,0.70536959553695955,0.83362357669122567,0.9250159134309357,0.82598471487360381,0.9748176450156304],\"text\":[\"year: 1896<br />ratio: 0.000000000\",\"year: 1900<br />ratio: 0.017341040\",\"year: 1904<br />ratio: 0.012451362\",\"year: 1906<br />ratio: 0.006387921\",\"year: 1908<br />ratio: 0.015389653\",\"year: 1912<br />ratio: 0.022008601\",\"year: 1920<br />ratio: 0.032227032\",\"year: 1924<br />ratio: 0.048048601\",\"year: 1928<br />ratio: 0.085069106\",\"year: 1932<br />ratio: 0.125000000\",\"year: 1936<br />ratio: 0.080122592\",\"year: 1948<br />ratio: 0.113260902\",\"year: 1952<br />ratio: 0.219124544\",\"year: 1956<br />ratio: 0.215108593\",\"year: 1960<br />ratio: 0.230512991\",\"year: 1964<br />ratio: 0.226708075\",\"year: 1968<br />ratio: 0.264663287\",\"year: 1972<br />ratio: 0.278900652\",\"year: 1976<br />ratio: 0.330040527\",\"year: 1980<br />ratio: 0.323803881\",\"year: 1984<br />ratio: 0.346658919\",\"year: 1988<br />ratio: 0.403998852\",\"year: 1992<br />ratio: 0.460881175\",\"year: 1994<br />ratio: 0.537712895\",\"year: 1996<br />ratio: 0.570907433\",\"year: 1998<br />ratio: 0.623142729\",\"year: 2000<br />ratio: 0.647318236\",\"year: 2002<br />ratio: 0.626038781\",\"year: 2004<br />ratio: 0.702292010\",\"year: 2006<br />ratio: 0.669333333\",\"year: 2008<br />ratio: 0.746981762\",\"year: 2010<br />ratio: 0.722896282\",\"year: 2012<br />ratio: 0.818437720\",\"year: 2014<br />ratio: 0.705369596\",\"year: 2016<br />ratio: 0.833623577\",\"year: 2020<br />ratio: 0.925015913\",\"year: 2022<br />ratio: 0.825984715\",\"year: 2024<br />ratio: 0.974817645\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":7.559055118110237,\"color\":\"rgba(20,33,61,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":48.949771689497723},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Gender ratio in the Olympics by year\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[1889.5999999999999,2030.4000000000001],\"tickmode\":\"array\",\"ticktext\":[\"1920\",\"1960\",\"2000\"],\"tickvals\":[1920,1960,2000],\"categoryorder\":\"array\",\"categoryarray\":[\"1920\",\"1960\",\"2000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"year\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.04874088225078152,1.0235585272664118],\"tickmode\":\"array\",\"ticktext\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"categoryorder\":\"array\",\"categoryarray\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Ratio\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"297c4d927594\":{\"x\":{},\"y\":{},\"type\":\"scatter\"}},\"cur_data\":\"297c4d927594\",\"visdat\":{\"297c4d927594\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n#### نسبت مشارکت مردان و زنان در المپیک\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngender_distribution <- olympic_1896_2024_clean %>%\n  group_by(year, sex) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(year) %>%\n  mutate(total_count = sum(count),\n         percentage = count / total_count * 100)\n\ngender_plot <- ggplot(gender_distribution, aes(x = year, y = percentage, fill = sex)) +\n  geom_area(linetype = 1, size = 0.001, color = \"blue\") +\n  scale_fill_manual(values = c(\"Male\" = \"blue\", \"Female\" = \"#BF2EF0\")) +\n  labs(title = \"Gender Distribution in Olympic Games Over Time\",\n       x = \"Year\", fill = \"Gender\") +\n  annotate(\"text\", x = 1925, y = 25, \n           label = \"Male\", color = \"white\", vjust = -1, size = 8) +\n  annotate(\"text\", x = 2000, y = 80, \n           label = \"Female\", color = \"white\", vjust = -1, size = 8, angle = -20) +\n  scale_x_continuous(breaks = seq(1896, 2024, by = 25)) +\n  theme_minimal() +\n  theme(axis.title.y = element_blank(),\n        axis.text.y = element_blank(),\n        axis.ticks.y = element_blank(),\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        legend.position = \"none\")\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-8d8a708359bfa1ab4c3b\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8d8a708359bfa1ab4c3b\">{\"x\":{\"data\":[{\"x\":[1899.8720000000001,1900,1900.1279999999999,1903.8720000000001,1904,1904.1279999999999,1905.8720000000001,1906,1906.1279999999999,1907.8720000000001,1908,1908.1279999999999,1911.8720000000001,1912,1912.1279999999999,1919.8720000000001,1920,1920.1279999999999,1923.8720000000001,1924,1924.1279999999999,1927.8720000000001,1928,1928.1279999999999,1931.8720000000001,1932,1932.1279999999999,1935.8720000000001,1936,1936.1279999999999,1947.8720000000001,1948,1948.1279999999999,1951.8720000000001,1952,1952.1279999999999,1955.8720000000001,1956,1956.1279999999999,1959.8720000000001,1960,1960.1279999999999,1963.8720000000001,1964,1964.1279999999999,1967.8720000000001,1968,1968.1279999999999,1971.8720000000001,1972,1972.1279999999999,1975.8720000000001,1976,1976.1279999999999,1979.8720000000001,1980,1980.1279999999999,1983.8720000000001,1984,1984.1279999999999,1987.8720000000001,1988,1988.1279999999999,1991.8720000000001,1992,1992.1279999999999,1993.8720000000001,1994,1994.1279999999999,1995.8720000000001,1996,1996.1279999999999,1997.8720000000001,1998,1998.1279999999999,1999.8720000000001,2000,2000.1279999999999,2001.8720000000001,2002,2002.1279999999999,2003.8720000000001,2004,2004.1279999999999,2005.8720000000001,2006,2006.1279999999999,2007.8720000000001,2008,2008.1279999999999,2009.8720000000001,2010,2010.1279999999999,2011.8720000000001,2012,2012.1279999999999,2013.8720000000001,2014,2014.1279999999999,2015.8720000000001,2016,2016.1279999999999,2019.8720000000001,2020,2020.1279999999999,2021.8720000000001,2022,2022.1279999999999,2023.8720000000001,2024,2024.1279999999999,2024.1279999999999,2024,2023.8720000000001,2022.1279999999999,2022,2021.8720000000001,2020.1279999999999,2020,2019.8720000000001,2016.1279999999999,2016,2015.8720000000001,2014.1279999999999,2014,2013.8720000000001,2012.1279999999999,2012,2011.8720000000001,2010.1279999999999,2010,2009.8720000000001,2008.1279999999999,2008,2007.8720000000001,2006.1279999999999,2006,2005.8720000000001,2004.1279999999999,2004,2003.8720000000001,2002.1279999999999,2002,2001.8720000000001,2000.1279999999999,2000,1999.8720000000001,1998.1279999999999,1998,1997.8720000000001,1996.1279999999999,1996,1995.8720000000001,1994.1279999999999,1994,1993.8720000000001,1992.1279999999999,1992,1991.8720000000001,1988.1279999999999,1988,1987.8720000000001,1984.1279999999999,1984,1983.8720000000001,1980.1279999999999,1980,1979.8720000000001,1976.1279999999999,1976,1975.8720000000001,1972.1279999999999,1972,1971.8720000000001,1968.1279999999999,1968,1967.8720000000001,1964.1279999999999,1964,1963.8720000000001,1960.1279999999999,1960,1959.8720000000001,1956.1279999999999,1956,1955.8720000000001,1952.1279999999999,1952,1951.8720000000001,1948.1279999999999,1948,1947.8720000000001,1936.1279999999999,1936,1935.8720000000001,1932.1279999999999,1932,1931.8720000000001,1928.1279999999999,1928,1927.8720000000001,1924.1279999999999,1924,1923.8720000000001,1920.1279999999999,1920,1919.8720000000001,1912.1279999999999,1912,1911.8720000000001,1908.1279999999999,1908,1907.8720000000001,1906.1279999999999,1906,1905.8720000000001,1904.1279999999999,1904,1903.8720000000001,1900.1279999999999,1900,1899.8720000000001,1899.8720000000001],\"y\":[98.349999999999966,98.295454545454547,98.310645657186768,98.754985675354632,98.770176787086854,98.808262275944671,99.327177061632653,99.365262550490471,99.308884779829256,98.540737654569625,98.484359883908411,98.463949476534239,97.866945060839512,97.846534653465341,97.831036697332365,96.893410351286747,96.877912395153771,96.831112716864752,95.462222126910135,95.415422448621115,95.311249848815706,92.264201304505804,92.160028704700395,92.05535223059448,88.993565362994801,88.888888888888886,89.007071116515718,92.463901274602591,92.582083502229423,92.552687445763596,89.855599265021979,89.826203208556151,89.576599072200082,82.275678083780733,82.026073947424663,82.034749061989885,82.288496163022586,82.297171277587807,82.264203215221528,81.299887391007317,81.266919328641038,81.274985505061224,81.510921165351974,81.51898734177216,81.440697525249462,79.150720391959297,79.072430575436599,79.044261806137115,78.220325304126817,78.192156534827333,78.09594925109856,75.281886202030051,75.185678918301278,75.197013683908139,75.528555577908861,75.539890343515722,75.49886514696577,74.298878147878909,74.257852951328957,74.16080579970469,71.32217661469322,71.225129463068953,71.136384102923074,68.540582318654373,68.451836958508494,68.232944709619773,65.250537818508974,65.031645569620252,64.943698627620336,63.745421542870737,63.65747460087082,63.526364326276465,61.73998683492723,61.608876560332874,61.551010840907168,60.762590413731473,60.704724694305767,60.755567799389759,61.448305106159623,61.499148211243615,61.322839711515982,58.920636402725471,58.744327902997838,58.818556731902419,59.829924525728003,59.904153354632584,59.733748795633886,57.411986679275131,57.241582120276433,57.292796012238867,57.990585290227479,58.041799182189912,57.846628678492714,55.187430565616708,54.992260061919509,55.225607595425352,58.404967739444473,58.638315272950315,58.375819612138564,54.799316233576221,54.536820572764469,54.453966234811688,52.030476849691425,51.947622511738643,52.127932816512065,54.584660719051442,54.764971023824863,54.500818436298637,50.901739431251492,50.637586843725266,0,0,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,99.999999999999986,100,100,100,100,100,100,100,100,100,100,100,100,100.00000000000001,100,100.00000000000001,100,100.00000000000001,100.00000000000001,100,100.00000000000001,100.00000000000001,100,100,100,100,100,99.999999999999986,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,99.999999999999986,100,99.999999999999986,100,99.999999999999986,99.999999999999986,100,100,100,100,100,98.349999999999966,98.349999999999966],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":0.0037795275590551186,\"color\":\"rgba(0,0,255,1)\",\"dash\":\"solid\"},\"fill\":\"toself\",\"fillcolor\":\"rgba(191,46,240,1)\",\"hoveron\":\"points\",\"name\":\"Female\",\"legendgroup\":\"Female\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1895.8720000000001,1896,1896.1279999999999,1899.8720000000001,1900,1900.1279999999999,1903.8720000000001,1904,1904.1279999999999,1905.8720000000001,1906,1906.1279999999999,1907.8720000000001,1908,1908.1279999999999,1911.8720000000001,1912,1912.1279999999999,1919.8720000000001,1920,1920.1279999999999,1923.8720000000001,1924,1924.1279999999999,1927.8720000000001,1928,1928.1279999999999,1931.8720000000001,1932,1932.1279999999999,1935.8720000000001,1936,1936.1279999999999,1947.8720000000001,1948,1948.1279999999999,1951.8720000000001,1952,1952.1279999999999,1955.8720000000001,1956,1956.1279999999999,1959.8720000000001,1960,1960.1279999999999,1963.8720000000001,1964,1964.1279999999999,1967.8720000000001,1968,1968.1279999999999,1971.8720000000001,1972,1972.1279999999999,1975.8720000000001,1976,1976.1279999999999,1979.8720000000001,1980,1980.1279999999999,1983.8720000000001,1984,1984.1279999999999,1987.8720000000001,1988,1988.1279999999999,1991.8720000000001,1992,1992.1279999999999,1993.8720000000001,1994,1994.1279999999999,1995.8720000000001,1996,1996.1279999999999,1997.8720000000001,1998,1998.1279999999999,1999.8720000000001,2000,2000.1279999999999,2001.8720000000001,2002,2002.1279999999999,2003.8720000000001,2004,2004.1279999999999,2005.8720000000001,2006,2006.1279999999999,2007.8720000000001,2008,2008.1279999999999,2009.8720000000001,2010,2010.1279999999999,2011.8720000000001,2012,2012.1279999999999,2013.8720000000001,2014,2014.1279999999999,2015.8720000000001,2016,2016.1279999999999,2019.8720000000001,2020,2020.1279999999999,2021.8720000000001,2022,2022.1279999999999,2023.8720000000001,2024,2024.1279999999999,2024.1279999999999,2024.1279999999999,2024,2023.8720000000001,2022.1279999999999,2022,2021.8720000000001,2020.1279999999999,2020,2019.8720000000001,2016.1279999999999,2016,2015.8720000000001,2014.1279999999999,2014,2013.8720000000001,2012.1279999999999,2012,2011.8720000000001,2010.1279999999999,2010,2009.8720000000001,2008.1279999999999,2008,2007.8720000000001,2006.1279999999999,2006,2005.8720000000001,2004.1279999999999,2004,2003.8720000000001,2002.1279999999999,2002,2001.8720000000001,2000.1279999999999,2000,1999.8720000000001,1998.1279999999999,1998,1997.8720000000001,1996.1279999999999,1996,1995.8720000000001,1994.1279999999999,1994,1993.8720000000001,1992.1279999999999,1992,1991.8720000000001,1988.1279999999999,1988,1987.8720000000001,1984.1279999999999,1984,1983.8720000000001,1980.1279999999999,1980,1979.8720000000001,1976.1279999999999,1976,1975.8720000000001,1972.1279999999999,1972,1971.8720000000001,1968.1279999999999,1968,1967.8720000000001,1964.1279999999999,1964,1963.8720000000001,1960.1279999999999,1960,1959.8720000000001,1956.1279999999999,1956,1955.8720000000001,1952.1279999999999,1952,1951.8720000000001,1948.1279999999999,1948,1947.8720000000001,1936.1279999999999,1936,1935.8720000000001,1932.1279999999999,1932,1931.8720000000001,1928.1279999999999,1928,1927.8720000000001,1924.1279999999999,1924,1923.8720000000001,1920.1279999999999,1920,1919.8720000000001,1912.1279999999999,1912,1911.8720000000001,1908.1279999999999,1908,1907.8720000000001,1906.1279999999999,1906,1905.8720000000001,1904.1279999999999,1904,1903.8720000000001,1900.1279999999999,1900,1899.8720000000001,1896.1279999999999,1896,1895.8720000000001,1895.8720000000001],\"y\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50.637586843725266,50.901739431251492,54.500818436298637,54.764971023824863,54.584660719051442,52.127932816512065,51.947622511738643,52.030476849691425,54.453966234811688,54.536820572764469,54.799316233576221,58.375819612138564,58.638315272950315,58.404967739444473,55.225607595425352,54.992260061919509,55.187430565616708,57.846628678492714,58.041799182189912,57.990585290227479,57.292796012238867,57.241582120276433,57.411986679275131,59.733748795633886,59.904153354632584,59.829924525728003,58.818556731902419,58.744327902997838,58.920636402725471,61.322839711515982,61.499148211243615,61.448305106159623,60.755567799389759,60.704724694305767,60.762590413731473,61.551010840907168,61.608876560332874,61.73998683492723,63.526364326276465,63.65747460087082,63.745421542870737,64.943698627620336,65.031645569620252,65.250537818508974,68.232944709619773,68.451836958508494,68.540582318654373,71.136384102923074,71.225129463068953,71.32217661469322,74.16080579970469,74.257852951328957,74.298878147878909,75.49886514696577,75.539890343515722,75.528555577908861,75.197013683908139,75.185678918301278,75.281886202030051,78.09594925109856,78.192156534827333,78.220325304126817,79.044261806137115,79.072430575436599,79.150720391959297,81.440697525249462,81.51898734177216,81.510921165351974,81.274985505061224,81.266919328641038,81.299887391007317,82.264203215221528,82.297171277587807,82.288496163022586,82.034749061989885,82.026073947424663,82.275678083780733,89.576599072200082,89.826203208556151,89.855599265021979,92.552687445763596,92.582083502229423,92.463901274602591,89.007071116515718,88.888888888888886,88.993565362994801,92.05535223059448,92.160028704700395,92.264201304505804,95.311249848815706,95.415422448621115,95.462222126910135,96.831112716864752,96.877912395153771,96.893410351286747,97.831036697332365,97.846534653465341,97.866945060839512,98.463949476534239,98.484359883908411,98.540737654569625,99.308884779829256,99.365262550490471,99.327177061632653,98.808262275944671,98.770176787086854,98.754985675354632,98.310645657186768,98.295454545454547,98.349999999999966,99.945454545454581,100,0,0],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":0.0037795275590551186,\"color\":\"rgba(0,0,255,1)\",\"dash\":\"solid\"},\"fill\":\"toself\",\"fillcolor\":\"rgba(0,0,255,1)\",\"hoveron\":\"points\",\"name\":\"Male\",\"legendgroup\":\"Male\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1925],\"y\":[25],\"text\":\"Male\",\"hovertext\":\"\",\"textfont\":{\"size\":30.236220472440948,\"color\":\"rgba(255,255,255,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[2000],\"y\":[80],\"text\":\"Female\",\"hovertext\":\"\",\"textfont\":{\"size\":30.236220472440948,\"color\":\"rgba(255,255,255,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":10.958904109589042},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Gender Distribution in Olympic Games Over Time\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[1889.4592,2030.5408],\"tickmode\":\"array\",\"ticktext\":[\"1896\",\"1921\",\"1946\",\"1971\",\"1996\",\"2021\"],\"tickvals\":[1896,1921,1946,1971,1996,2021],\"categoryorder\":\"array\",\"categoryarray\":[\"1896\",\"1921\",\"1946\",\"1971\",\"1996\",\"2021\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Year\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-5.0000000000000009,105.00000000000001],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"25\",\"50\",\"75\",\"100\"],\"tickvals\":[0,25,50,75,100],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"25\",\"50\",\"75\",\"100\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":false,\"tickfont\":{\"color\":null,\"family\":null,\"size\":0},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":null,\"family\":null,\"size\":0}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"297c78321c75\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"scatter\"},\"297c6778557c\":{\"x\":{},\"y\":{}},\"297c7af265fc\":{\"x\":{},\"y\":{}}},\"cur_data\":\"297c78321c75\",\"visdat\":{\"297c78321c75\":[\"function (y) \",\"x\"],\"297c6778557c\":[\"function (y) \",\"x\"],\"297c7af265fc\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n#### نسبت مشارکت مردان و زنان در المپیک (جارت دوم)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngender_inequality_in_years <- ggplot(gender_distribution, aes(x = year, y = percentage, color = sex))+\n  geom_line(linewidth = 1, linetype = 3)+\n  geom_point(size = 2, alpha= 0.5)+\n  scale_color_manual(values = c(\"Male\" = \"blue\", \"Female\" = \"red\"))+\n  ggtitle(\"Percentage of Gender Dist\")+\n  annotate(\"text\", x = 1960, y = 13, \n           label = \"Female\", color = \"red\", vjust = -1) +\n  annotate(\"text\", x = 1960, y = 95, \n           label = \"Male\", color = \"blue\", vjust = 11)+\n  scale_x_continuous(breaks = seq(1896, 2024, by = 25)) +\n  guides(color = FALSE)+\n  theme_ipsum()\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-c330c96ba6280e4c8f82\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c330c96ba6280e4c8f82\">{\"x\":{\"data\":[{\"x\":[1896,1900,1904,1906,1908,1912,1920,1924,1928,1932,1936,1948,1952,1956,1960,1964,1968,1972,1976,1980,1984,1988,1992,1994,1996,1998,2000,2002,2004,2006,2008,2010,2012,2014,2016,2020,2022,2024],\"y\":[100,98.295454545454547,98.770176787086854,99.365262550490471,98.484359883908411,97.846534653465341,96.877912395153771,95.415422448621115,92.160028704700395,88.888888888888886,92.582083502229423,89.826203208556151,82.026073947424663,82.297171277587807,81.266919328641038,81.51898734177216,79.072430575436599,78.192156534827333,75.185678918301278,75.539890343515722,74.257852951328957,71.225129463068953,68.451836958508494,65.031645569620252,63.65747460087082,61.608876560332874,60.704724694305767,61.499148211243615,58.744327902997838,59.904153354632584,57.241582120276433,58.041799182189912,54.992260061919509,58.638315272950315,54.536820572764469,51.947622511738643,54.764971023824863,50.637586843725266],\"text\":[\"year: 1896<br />percentage: 100.0000000<br />sex: Male\",\"year: 1900<br />percentage:  98.2954545<br />sex: Male\",\"year: 1904<br />percentage:  98.7701768<br />sex: Male\",\"year: 1906<br />percentage:  99.3652626<br />sex: Male\",\"year: 1908<br />percentage:  98.4843599<br />sex: Male\",\"year: 1912<br />percentage:  97.8465347<br />sex: Male\",\"year: 1920<br />percentage:  96.8779124<br />sex: Male\",\"year: 1924<br />percentage:  95.4154224<br />sex: Male\",\"year: 1928<br />percentage:  92.1600287<br />sex: Male\",\"year: 1932<br />percentage:  88.8888889<br />sex: Male\",\"year: 1936<br />percentage:  92.5820835<br />sex: Male\",\"year: 1948<br />percentage:  89.8262032<br />sex: Male\",\"year: 1952<br />percentage:  82.0260739<br />sex: Male\",\"year: 1956<br />percentage:  82.2971713<br />sex: Male\",\"year: 1960<br />percentage:  81.2669193<br />sex: Male\",\"year: 1964<br />percentage:  81.5189873<br />sex: Male\",\"year: 1968<br />percentage:  79.0724306<br />sex: Male\",\"year: 1972<br />percentage:  78.1921565<br />sex: Male\",\"year: 1976<br />percentage:  75.1856789<br />sex: Male\",\"year: 1980<br />percentage:  75.5398903<br />sex: Male\",\"year: 1984<br />percentage:  74.2578530<br />sex: Male\",\"year: 1988<br />percentage:  71.2251295<br />sex: Male\",\"year: 1992<br />percentage:  68.4518370<br />sex: Male\",\"year: 1994<br />percentage:  65.0316456<br />sex: Male\",\"year: 1996<br />percentage:  63.6574746<br />sex: Male\",\"year: 1998<br />percentage:  61.6088766<br />sex: Male\",\"year: 2000<br />percentage:  60.7047247<br />sex: Male\",\"year: 2002<br />percentage:  61.4991482<br />sex: Male\",\"year: 2004<br />percentage:  58.7443279<br />sex: Male\",\"year: 2006<br />percentage:  59.9041534<br />sex: Male\",\"year: 2008<br />percentage:  57.2415821<br />sex: Male\",\"year: 2010<br />percentage:  58.0417992<br />sex: Male\",\"year: 2012<br />percentage:  54.9922601<br />sex: Male\",\"year: 2014<br />percentage:  58.6383153<br />sex: Male\",\"year: 2016<br />percentage:  54.5368206<br />sex: Male\",\"year: 2020<br />percentage:  51.9476225<br />sex: Male\",\"year: 2022<br />percentage:  54.7649710<br />sex: Male\",\"year: 2024<br />percentage:  50.6375868<br />sex: Male\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":3.7795275590551185,\"color\":\"rgba(0,0,255,1)\",\"dash\":\"dot\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,0,255,1)\",\"opacity\":0.5,\"size\":7.559055118110237,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,255,1)\"}},\"frame\":null},{\"x\":[1900,1904,1906,1908,1912,1920,1924,1928,1932,1936,1948,1952,1956,1960,1964,1968,1972,1976,1980,1984,1988,1992,1994,1996,1998,2000,2002,2004,2006,2008,2010,2012,2014,2016,2020,2022,2024],\"y\":[1.7045454545454544,1.2298232129131437,0.63473744950952105,1.5156401160915833,2.1534653465346532,3.1220876048462256,4.584577551378886,7.8399712952996055,11.111111111111111,7.4179164977705714,10.17379679144385,17.973926052575337,17.702828722412185,18.733080671358959,18.481012658227851,20.927569424563412,21.807843465172674,24.814321081698722,24.460109656484281,25.742147048671036,28.774870536931047,31.548163041491499,34.968354430379748,36.342525399129173,38.391123439667126,39.295275305694233,38.500851788756393,41.255672097002154,40.095846645367409,42.758417879723574,41.958200817810088,45.007739938080491,41.361684727049685,45.463179427235531,48.052377488261364,45.235028976175144,49.362413156274734],\"text\":[\"year: 1900<br />percentage:   1.7045455<br />sex: Female\",\"year: 1904<br />percentage:   1.2298232<br />sex: Female\",\"year: 1906<br />percentage:   0.6347374<br />sex: Female\",\"year: 1908<br />percentage:   1.5156401<br />sex: Female\",\"year: 1912<br />percentage:   2.1534653<br />sex: Female\",\"year: 1920<br />percentage:   3.1220876<br />sex: Female\",\"year: 1924<br />percentage:   4.5845776<br />sex: Female\",\"year: 1928<br />percentage:   7.8399713<br />sex: Female\",\"year: 1932<br />percentage:  11.1111111<br />sex: Female\",\"year: 1936<br />percentage:   7.4179165<br />sex: Female\",\"year: 1948<br />percentage:  10.1737968<br />sex: Female\",\"year: 1952<br />percentage:  17.9739261<br />sex: Female\",\"year: 1956<br />percentage:  17.7028287<br />sex: Female\",\"year: 1960<br />percentage:  18.7330807<br />sex: Female\",\"year: 1964<br />percentage:  18.4810127<br />sex: Female\",\"year: 1968<br />percentage:  20.9275694<br />sex: Female\",\"year: 1972<br />percentage:  21.8078435<br />sex: Female\",\"year: 1976<br />percentage:  24.8143211<br />sex: Female\",\"year: 1980<br />percentage:  24.4601097<br />sex: Female\",\"year: 1984<br />percentage:  25.7421470<br />sex: Female\",\"year: 1988<br />percentage:  28.7748705<br />sex: Female\",\"year: 1992<br />percentage:  31.5481630<br />sex: Female\",\"year: 1994<br />percentage:  34.9683544<br />sex: Female\",\"year: 1996<br />percentage:  36.3425254<br />sex: Female\",\"year: 1998<br />percentage:  38.3911234<br />sex: Female\",\"year: 2000<br />percentage:  39.2952753<br />sex: Female\",\"year: 2002<br />percentage:  38.5008518<br />sex: Female\",\"year: 2004<br />percentage:  41.2556721<br />sex: Female\",\"year: 2006<br />percentage:  40.0958466<br />sex: Female\",\"year: 2008<br />percentage:  42.7584179<br />sex: Female\",\"year: 2010<br />percentage:  41.9582008<br />sex: Female\",\"year: 2012<br />percentage:  45.0077399<br />sex: Female\",\"year: 2014<br />percentage:  41.3616847<br />sex: Female\",\"year: 2016<br />percentage:  45.4631794<br />sex: Female\",\"year: 2020<br />percentage:  48.0523775<br />sex: Female\",\"year: 2022<br />percentage:  45.2350290<br />sex: Female\",\"year: 2024<br />percentage:  49.3624132<br />sex: Female\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":3.7795275590551185,\"color\":\"rgba(255,0,0,1)\",\"dash\":\"dot\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,0,0,1)\",\"opacity\":0.5,\"size\":7.559055118110237,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,0,0,1)\"}},\"frame\":null},{\"x\":[1960],\"y\":[13],\"text\":\"Female\",\"hovertext\":\"x: 1960<br />y: 13\",\"textfont\":{\"size\":14.66456692913386,\"color\":\"rgba(255,0,0,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1960],\"y\":[95],\"text\":\"Male\",\"hovertext\":\"x: 1960<br />y: 95\",\"textfont\":{\"size\":14.66456692913386,\"color\":\"rgba(0,0,255,1)\"},\"type\":\"scatter\",\"mode\":\"text\",\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":95.701120797011214,\"r\":39.850560398505614,\"b\":86.841012868410132,\"l\":78.538812785388146},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483},\"title\":{\"text\":\"<b> Percentage of Gender Dist <\\/b>\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":23.910336239103366},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[1889.5999999999999,2030.4000000000001],\"tickmode\":\"array\",\"ticktext\":[\"1896\",\"1921\",\"1946\",\"1971\",\"1996\",\"2021\"],\"tickvals\":[1896,1921,1946,1971,1996,2021],\"categoryorder\":\"array\",\"categoryarray\":[\"1896\",\"1921\",\"1946\",\"1971\",\"1996\",\"2021\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.8190120381901207,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(204,204,204,1)\",\"gridwidth\":0.265670402656704,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"year\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":11.955168119551683}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-4.333525678015004,104.96826312752452],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"25\",\"50\",\"75\",\"100\"],\"tickvals\":[0,25,50,75,100],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"25\",\"50\",\"75\",\"100\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.8190120381901207,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(204,204,204,1)\",\"gridwidth\":0.26567040265670405,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"percentage\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":11.955168119551683}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":12.220838522208389},\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"Arial Narrow\",\"size\":15.276048152760483}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"297c5d18120f\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"},\"297c7e067f00\":{\"x\":{},\"y\":{},\"colour\":{}},\"297c3d22507c\":{\"x\":{},\"y\":{}},\"297c3a5a296f\":{\"x\":{},\"y\":{}}},\"cur_data\":\"297c5d18120f\",\"visdat\":{\"297c5d18120f\":[\"function (y) \",\"x\"],\"297c7e067f00\":[\"function (y) \",\"x\"],\"297c3d22507c\":[\"function (y) \",\"x\"],\"297c3a5a296f\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n### مدال‌ها را کی برد خونه؟\n\n#### کشورها با بیشتر مدال کسب شده در تاریخ المپیک\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(waffle)\nmedal_counts <- olympic_1896_2024_clean %>%\n  filter(!is.na(medal)) %>% \n  group_by(country, medal) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  arrange(desc(count))\n\ntop_countries <- medal_counts %>%\n  group_by(country) %>%\n  summarise(total_medals = sum(count)) %>%\n  arrange(desc(total_medals)) %>%\n  head(10)\n\ntop_medal_counts <- medal_counts %>%\n  filter(country %in% top_countries$country)\n\nwaffle_data <- top_medal_counts %>%\n  mutate(medal = factor(medal, levels = c(\"Gold\", \"Silver\", \"Bronze\"))) %>%    \n  group_by(country, medal) %>%\n  summarise(count = sum(count), .groups = 'drop') %>%\n  ungroup() %>%\n  group_by(country) %>%\n  mutate(total = sum(count)) %>%\n  ungroup() %>%\n  arrange(desc(total))\n\nwaffle_data <- waffle_data %>%\n  mutate(country = reorder(country, -total))\n\n# ایجاد وافل چارت\nwaffle_chart <- ggplot(waffle_data, aes(fill = medal, values = count)) +\n  geom_waffle(color = \"white\", size = 0.1, n_rows = 50, flip = TRUE) +\n  scale_fill_manual(values = c(\"Gold\" = \"gold\", \"Silver\" = \"gray\", \"Bronze\" = \"darkorange\")) +\n  facet_wrap(~ country, nrow = 1, strip.position = \"bottom\") +\n  scale_x_discrete() + \n  scale_y_continuous(labels = function(x) x * 10,\n                     expand = c(0,0)) +\n  theme_void() +\n  labs(title = \"10 countries based on total number of medals\",\n       subtitle = \"Between 1896 ~ 2024 olympics\",\n       fill = \"Medal\",\n       caption = \"Note: Soviet Union and Russia are intentionally separated\\nChart: Alireza Chamanzar\\nSource: Kaggle Community\") +\n  theme(axis.title = element_blank(),\n        axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        panel.grid = element_blank(),\n        strip.text.x = element_text(size = 10), \n        plot.caption = element_text(hjust = 0, size = 8),\n        legend.position = \"top\",\n        legend.title = element_blank(),\n        legend.text = element_text(size=13,\n                             face = 'plain',\n                             color = \"grey10\"),\n        # TITLE\n        plot.title.position = \"plot\",\n        plot.title = element_text(size = 16,\n                            color = \"grey15\"),\n        # SUB-TITLE\n        plot.subtitle = element_text(size = 13,\n                            color = \"grey15\"),\n        plot.background = element_rect(color=\"white\", fill=\"white\"),\n        plot.margin = margin(20, 40, 20, 40))\n```\n:::\n\n\n\n![ده کشور برتر در تاریخ المپیک در کسب مدال](waffle_chart.jpg)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}